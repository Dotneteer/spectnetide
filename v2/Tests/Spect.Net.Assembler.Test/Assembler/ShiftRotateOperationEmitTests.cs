using Microsoft.VisualStudio.TestTools.UnitTesting;

namespace Spect.Net.Assembler.Test.Assembler
{
    [TestClass]
    public class ShiftRotateOperationEmitTests : AssemblerTestBed
    {
        [TestMethod]
        public void SrOpsWorkAsExpected()
        {
            CodeEmitWorks("rlc b", 0xCB, 0x00);
            CodeEmitWorks("rlc c", 0xCB, 0x01);
            CodeEmitWorks("rlc d", 0xCB, 0x02);
            CodeEmitWorks("rlc e", 0xCB, 0x03);
            CodeEmitWorks("rlc h", 0xCB, 0x04);
            CodeEmitWorks("rlc l", 0xCB, 0x05);
            CodeEmitWorks("rlc (hl)", 0xCB, 0x06);
            CodeEmitWorks("rlc a", 0xCB, 0x07);

            CodeEmitWorks("rrc b", 0xCB, 0x08);
            CodeEmitWorks("rrc c", 0xCB, 0x09);
            CodeEmitWorks("rrc d", 0xCB, 0x0A);
            CodeEmitWorks("rrc e", 0xCB, 0x0B);
            CodeEmitWorks("rrc h", 0xCB, 0x0C);
            CodeEmitWorks("rrc l", 0xCB, 0x0D);
            CodeEmitWorks("rrc (hl)", 0xCB, 0x0E);
            CodeEmitWorks("rrc a", 0xCB, 0x0F);

            CodeEmitWorks("rl b", 0xCB, 0x10);
            CodeEmitWorks("rl c", 0xCB, 0x11);
            CodeEmitWorks("rl d", 0xCB, 0x12);
            CodeEmitWorks("rl e", 0xCB, 0x13);
            CodeEmitWorks("rl h", 0xCB, 0x14);
            CodeEmitWorks("rl l", 0xCB, 0x15);
            CodeEmitWorks("rl (hl)", 0xCB, 0x16);
            CodeEmitWorks("rl a", 0xCB, 0x17);

            CodeEmitWorks("rr b", 0xCB, 0x18);
            CodeEmitWorks("rr c", 0xCB, 0x19);
            CodeEmitWorks("rr d", 0xCB, 0x1A);
            CodeEmitWorks("rr e", 0xCB, 0x1B);
            CodeEmitWorks("rr h", 0xCB, 0x1C);
            CodeEmitWorks("rr l", 0xCB, 0x1D);
            CodeEmitWorks("rr (hl)", 0xCB, 0x1E);
            CodeEmitWorks("rr a", 0xCB, 0x1F);

            CodeEmitWorks("sla b", 0xCB, 0x20);
            CodeEmitWorks("sla c", 0xCB, 0x21);
            CodeEmitWorks("sla d", 0xCB, 0x22);
            CodeEmitWorks("sla e", 0xCB, 0x23);
            CodeEmitWorks("sla h", 0xCB, 0x24);
            CodeEmitWorks("sla l", 0xCB, 0x25);
            CodeEmitWorks("sla (hl)", 0xCB, 0x26);
            CodeEmitWorks("sla a", 0xCB, 0x27);

            CodeEmitWorks("sra b", 0xCB, 0x28);
            CodeEmitWorks("sra c", 0xCB, 0x29);
            CodeEmitWorks("sra d", 0xCB, 0x2A);
            CodeEmitWorks("sra e", 0xCB, 0x2B);
            CodeEmitWorks("sra h", 0xCB, 0x2C);
            CodeEmitWorks("sra l", 0xCB, 0x2D);
            CodeEmitWorks("sra (hl)", 0xCB, 0x2E);
            CodeEmitWorks("sra a", 0xCB, 0x2F);

            CodeEmitWorks("sll b", 0xCB, 0x30);
            CodeEmitWorks("sll c", 0xCB, 0x31);
            CodeEmitWorks("sll d", 0xCB, 0x32);
            CodeEmitWorks("sll e", 0xCB, 0x33);
            CodeEmitWorks("sll h", 0xCB, 0x34);
            CodeEmitWorks("sll l", 0xCB, 0x35);
            CodeEmitWorks("sll (hl)", 0xCB, 0x36);
            CodeEmitWorks("sll a", 0xCB, 0x37);

            CodeEmitWorks("srl b", 0xCB, 0x38);
            CodeEmitWorks("srl c", 0xCB, 0x39);
            CodeEmitWorks("srl d", 0xCB, 0x3A);
            CodeEmitWorks("srl e", 0xCB, 0x3B);
            CodeEmitWorks("srl h", 0xCB, 0x3C);
            CodeEmitWorks("srl l", 0xCB, 0x3D);
            CodeEmitWorks("srl (hl)", 0xCB, 0x3E);
            CodeEmitWorks("srl a", 0xCB, 0x3F);
        }

        [TestMethod]
        public void IxIndexedSrOpsWorkAsExpected()
        {
            CodeEmitWorks("rlc (ix),b", 0xDD, 0xCB, 0x00, 0x00);
            CodeEmitWorks("rlc (ix+#0A),b", 0xDD, 0xCB, 0x00, 0x0A);
            CodeEmitWorks("rlc (ix-#08),b", 0xDD, 0xCB, 0x00, 0xF8);
            CodeEmitWorks("rlc (ix),c", 0xDD, 0xCB, 0x01, 0x00);
            CodeEmitWorks("rlc (ix+#0A),c", 0xDD, 0xCB, 0x01, 0x0A);
            CodeEmitWorks("rlc (ix-#08),c", 0xDD, 0xCB, 0x01, 0xF8);
            CodeEmitWorks("rlc (ix),d", 0xDD, 0xCB, 0x02, 0x00);
            CodeEmitWorks("rlc (ix+#0A),d", 0xDD, 0xCB, 0x02, 0x0A);
            CodeEmitWorks("rlc (ix-#08),d", 0xDD, 0xCB, 0x02, 0xF8);
            CodeEmitWorks("rlc (ix),e", 0xDD, 0xCB, 0x03, 0x00);
            CodeEmitWorks("rlc (ix+#0A),e", 0xDD, 0xCB, 0x03, 0x0A);
            CodeEmitWorks("rlc (ix-#08),e", 0xDD, 0xCB, 0x03, 0xF8);
            CodeEmitWorks("rlc (ix),h", 0xDD, 0xCB, 0x04, 0x00);
            CodeEmitWorks("rlc (ix+#0A),h", 0xDD, 0xCB, 0x04, 0x0A);
            CodeEmitWorks("rlc (ix-#08),h", 0xDD, 0xCB, 0x04, 0xF8);
            CodeEmitWorks("rlc (ix),l", 0xDD, 0xCB, 0x05, 0x00);
            CodeEmitWorks("rlc (ix+#0A),l", 0xDD, 0xCB, 0x05, 0x0A);
            CodeEmitWorks("rlc (ix-#08),l", 0xDD, 0xCB, 0x05, 0xF8);
            CodeEmitWorks("rlc (ix)", 0xDD, 0xCB, 0x06, 0x00);
            CodeEmitWorks("rlc (ix+#0A)", 0xDD, 0xCB, 0x06, 0x0A);
            CodeEmitWorks("rlc (ix-#08)", 0xDD, 0xCB, 0x06, 0xF8);
            CodeEmitWorks("rlc (ix),a", 0xDD, 0xCB, 0x07, 0x00);
            CodeEmitWorks("rlc (ix+#0A),a", 0xDD, 0xCB, 0x07, 0x0A);
            CodeEmitWorks("rlc (ix-#08),a", 0xDD, 0xCB, 0x07, 0xF8);

            CodeEmitWorks("rrc (ix),b", 0xDD, 0xCB, 0x08, 0x00);
            CodeEmitWorks("rrc (ix+#0A),b", 0xDD, 0xCB, 0x08, 0x0A);
            CodeEmitWorks("rrc (ix-#08),b", 0xDD, 0xCB, 0x08, 0xF8);
            CodeEmitWorks("rrc (ix),c", 0xDD, 0xCB, 0x09, 0x00);
            CodeEmitWorks("rrc (ix+#0A),c", 0xDD, 0xCB, 0x09, 0x0A);
            CodeEmitWorks("rrc (ix-#08),c", 0xDD, 0xCB, 0x09, 0xF8);
            CodeEmitWorks("rrc (ix),d", 0xDD, 0xCB, 0x0A, 0x00);
            CodeEmitWorks("rrc (ix+#0A),d", 0xDD, 0xCB, 0x0A, 0x0A);
            CodeEmitWorks("rrc (ix-#08),d", 0xDD, 0xCB, 0x0A, 0xF8);
            CodeEmitWorks("rrc (ix),e", 0xDD, 0xCB, 0x0B, 0x00);
            CodeEmitWorks("rrc (ix+#0A),e", 0xDD, 0xCB, 0x0B, 0x0A);
            CodeEmitWorks("rrc (ix-#08),e", 0xDD, 0xCB, 0x0B, 0xF8);
            CodeEmitWorks("rrc (ix),h", 0xDD, 0xCB, 0x0C, 0x00);
            CodeEmitWorks("rrc (ix+#0A),h", 0xDD, 0xCB, 0x0C, 0x0A);
            CodeEmitWorks("rrc (ix-#08),h", 0xDD, 0xCB, 0x0C, 0xF8);
            CodeEmitWorks("rrc (ix),l", 0xDD, 0xCB, 0x0D, 0x00);
            CodeEmitWorks("rrc (ix+#0A),l", 0xDD, 0xCB, 0x0D, 0x0A);
            CodeEmitWorks("rrc (ix-#08),l", 0xDD, 0xCB, 0x0D, 0xF8);
            CodeEmitWorks("rrc (ix)", 0xDD, 0xCB, 0x0E, 0x00);
            CodeEmitWorks("rrc (ix+#0A)", 0xDD, 0xCB, 0x0E, 0x0A);
            CodeEmitWorks("rrc (ix-#08)", 0xDD, 0xCB, 0x0E, 0xF8);
            CodeEmitWorks("rrc (ix),a", 0xDD, 0xCB, 0x0F, 0x00);
            CodeEmitWorks("rrc (ix+#0A),a", 0xDD, 0xCB, 0x0F, 0x0A);
            CodeEmitWorks("rrc (ix-#08),a", 0xDD, 0xCB, 0x0F, 0xF8);

            CodeEmitWorks("rl (ix),b", 0xDD, 0xCB, 0x10, 0x00);
            CodeEmitWorks("rl (ix+#0A),b", 0xDD, 0xCB, 0x10, 0x0A);
            CodeEmitWorks("rl (ix-#08),b", 0xDD, 0xCB, 0x10, 0xF8);
            CodeEmitWorks("rl (ix),c", 0xDD, 0xCB, 0x11, 0x00);
            CodeEmitWorks("rl (ix+#0A),c", 0xDD, 0xCB, 0x11, 0x0A);
            CodeEmitWorks("rl (ix-#08),c", 0xDD, 0xCB, 0x11, 0xF8);
            CodeEmitWorks("rl (ix),d", 0xDD, 0xCB, 0x12, 0x00);
            CodeEmitWorks("rl (ix+#0A),d", 0xDD, 0xCB, 0x12, 0x0A);
            CodeEmitWorks("rl (ix-#08),d", 0xDD, 0xCB, 0x12, 0xF8);
            CodeEmitWorks("rl (ix),e", 0xDD, 0xCB, 0x13, 0x00);
            CodeEmitWorks("rl (ix+#0A),e", 0xDD, 0xCB, 0x13, 0x0A);
            CodeEmitWorks("rl (ix-#08),e", 0xDD, 0xCB, 0x13, 0xF8);
            CodeEmitWorks("rl (ix),h", 0xDD, 0xCB, 0x14, 0x00);
            CodeEmitWorks("rl (ix+#0A),h", 0xDD, 0xCB, 0x14, 0x0A);
            CodeEmitWorks("rl (ix-#08),h", 0xDD, 0xCB, 0x14, 0xF8);
            CodeEmitWorks("rl (ix),l", 0xDD, 0xCB, 0x15, 0x00);
            CodeEmitWorks("rl (ix+#0A),l", 0xDD, 0xCB, 0x15, 0x0A);
            CodeEmitWorks("rl (ix-#08),l", 0xDD, 0xCB, 0x15, 0xF8);
            CodeEmitWorks("rl (ix)", 0xDD, 0xCB, 0x16, 0x00);
            CodeEmitWorks("rl (ix+#0A)", 0xDD, 0xCB, 0x16, 0x0A);
            CodeEmitWorks("rl (ix-#08)", 0xDD, 0xCB, 0x16, 0xF8);
            CodeEmitWorks("rl (ix),a", 0xDD, 0xCB, 0x17, 0x00);
            CodeEmitWorks("rl (ix+#0A),a", 0xDD, 0xCB, 0x17, 0x0A);
            CodeEmitWorks("rl (ix-#08),a", 0xDD, 0xCB, 0x17, 0xF8);

            CodeEmitWorks("rr (ix),b", 0xDD, 0xCB, 0x18, 0x00);
            CodeEmitWorks("rr (ix+#0A),b", 0xDD, 0xCB, 0x18, 0x0A);
            CodeEmitWorks("rr (ix-#08),b", 0xDD, 0xCB, 0x18, 0xF8);
            CodeEmitWorks("rr (ix),c", 0xDD, 0xCB, 0x19, 0x00);
            CodeEmitWorks("rr (ix+#0A),c", 0xDD, 0xCB, 0x19, 0x0A);
            CodeEmitWorks("rr (ix-#08),c", 0xDD, 0xCB, 0x19, 0xF8);
            CodeEmitWorks("rr (ix),d", 0xDD, 0xCB, 0x1A, 0x00);
            CodeEmitWorks("rr (ix+#0A),d", 0xDD, 0xCB, 0x1A, 0x0A);
            CodeEmitWorks("rr (ix-#08),d", 0xDD, 0xCB, 0x1A, 0xF8);
            CodeEmitWorks("rr (ix),e", 0xDD, 0xCB, 0x1B, 0x00);
            CodeEmitWorks("rr (ix+#0A),e", 0xDD, 0xCB, 0x1B, 0x0A);
            CodeEmitWorks("rr (ix-#08),e", 0xDD, 0xCB, 0x1B, 0xF8);
            CodeEmitWorks("rr (ix),h", 0xDD, 0xCB, 0x1C, 0x00);
            CodeEmitWorks("rr (ix+#0A),h", 0xDD, 0xCB, 0x1C, 0x0A);
            CodeEmitWorks("rr (ix-#08),h", 0xDD, 0xCB, 0x1C, 0xF8);
            CodeEmitWorks("rr (ix),l", 0xDD, 0xCB, 0x1D, 0x00);
            CodeEmitWorks("rr (ix+#0A),l", 0xDD, 0xCB, 0x1D, 0x0A);
            CodeEmitWorks("rr (ix-#08),l", 0xDD, 0xCB, 0x1D, 0xF8);
            CodeEmitWorks("rr (ix)", 0xDD, 0xCB, 0x1E, 0x00);
            CodeEmitWorks("rr (ix+#0A)", 0xDD, 0xCB, 0x1E, 0x0A);
            CodeEmitWorks("rr (ix-#08)", 0xDD, 0xCB, 0x1E, 0xF8);
            CodeEmitWorks("rr (ix),a", 0xDD, 0xCB, 0x1F, 0x00);
            CodeEmitWorks("rr (ix+#0A),a", 0xDD, 0xCB, 0x1F, 0x0A);
            CodeEmitWorks("rr (ix-#08),a", 0xDD, 0xCB, 0x1F, 0xF8);

            CodeEmitWorks("sla (ix),b", 0xDD, 0xCB, 0x20, 0x00);
            CodeEmitWorks("sla (ix+#0A),b", 0xDD, 0xCB, 0x20, 0x0A);
            CodeEmitWorks("sla (ix-#08),b", 0xDD, 0xCB, 0x20, 0xF8);
            CodeEmitWorks("sla (ix),c", 0xDD, 0xCB, 0x21, 0x00);
            CodeEmitWorks("sla (ix+#0A),c", 0xDD, 0xCB, 0x21, 0x0A);
            CodeEmitWorks("sla (ix-#08),c", 0xDD, 0xCB, 0x21, 0xF8);
            CodeEmitWorks("sla (ix),d", 0xDD, 0xCB, 0x22, 0x00);
            CodeEmitWorks("sla (ix+#0A),d", 0xDD, 0xCB, 0x22, 0x0A);
            CodeEmitWorks("sla (ix-#08),d", 0xDD, 0xCB, 0x22, 0xF8);
            CodeEmitWorks("sla (ix),e", 0xDD, 0xCB, 0x23, 0x00);
            CodeEmitWorks("sla (ix+#0A),e", 0xDD, 0xCB, 0x23, 0x0A);
            CodeEmitWorks("sla (ix-#08),e", 0xDD, 0xCB, 0x23, 0xF8);
            CodeEmitWorks("sla (ix),h", 0xDD, 0xCB, 0x24, 0x00);
            CodeEmitWorks("sla (ix+#0A),h", 0xDD, 0xCB, 0x24, 0x0A);
            CodeEmitWorks("sla (ix-#08),h", 0xDD, 0xCB, 0x24, 0xF8);
            CodeEmitWorks("sla (ix),l", 0xDD, 0xCB, 0x25, 0x00);
            CodeEmitWorks("sla (ix+#0A),l", 0xDD, 0xCB, 0x25, 0x0A);
            CodeEmitWorks("sla (ix-#08),l", 0xDD, 0xCB, 0x25, 0xF8);
            CodeEmitWorks("sla (ix)", 0xDD, 0xCB, 0x26, 0x00);
            CodeEmitWorks("sla (ix+#0A)", 0xDD, 0xCB, 0x26, 0x0A);
            CodeEmitWorks("sla (ix-#08)", 0xDD, 0xCB, 0x26, 0xF8);
            CodeEmitWorks("sla (ix),a", 0xDD, 0xCB, 0x27, 0x00);
            CodeEmitWorks("sla (ix+#0A),a", 0xDD, 0xCB, 0x27, 0x0A);
            CodeEmitWorks("sla (ix-#08),a", 0xDD, 0xCB, 0x27, 0xF8);

            CodeEmitWorks("sra (ix),b", 0xDD, 0xCB, 0x28, 0x00);
            CodeEmitWorks("sra (ix+#0A),b", 0xDD, 0xCB, 0x28, 0x0A);
            CodeEmitWorks("sra (ix-#08),b", 0xDD, 0xCB, 0x28, 0xF8);
            CodeEmitWorks("sra (ix),c", 0xDD, 0xCB, 0x29, 0x00);
            CodeEmitWorks("sra (ix+#0A),c", 0xDD, 0xCB, 0x29, 0x0A);
            CodeEmitWorks("sra (ix-#08),c", 0xDD, 0xCB, 0x29, 0xF8);
            CodeEmitWorks("sra (ix),d", 0xDD, 0xCB, 0x2A, 0x00);
            CodeEmitWorks("sra (ix+#0A),d", 0xDD, 0xCB, 0x2A, 0x0A);
            CodeEmitWorks("sra (ix-#08),d", 0xDD, 0xCB, 0x2A, 0xF8);
            CodeEmitWorks("sra (ix),e", 0xDD, 0xCB, 0x2B, 0x00);
            CodeEmitWorks("sra (ix+#0A),e", 0xDD, 0xCB, 0x2B, 0x0A);
            CodeEmitWorks("sra (ix-#08),e", 0xDD, 0xCB, 0x2B, 0xF8);
            CodeEmitWorks("sra (ix),h", 0xDD, 0xCB, 0x2C, 0x00);
            CodeEmitWorks("sra (ix+#0A),h", 0xDD, 0xCB, 0x2C, 0x0A);
            CodeEmitWorks("sra (ix-#08),h", 0xDD, 0xCB, 0x2C, 0xF8);
            CodeEmitWorks("sra (ix),l", 0xDD, 0xCB, 0x2D, 0x00);
            CodeEmitWorks("sra (ix+#0A),l", 0xDD, 0xCB, 0x2D, 0x0A);
            CodeEmitWorks("sra (ix-#08),l", 0xDD, 0xCB, 0x2D, 0xF8);
            CodeEmitWorks("sra (ix)", 0xDD, 0xCB, 0x2E, 0x00);
            CodeEmitWorks("sra (ix+#0A)", 0xDD, 0xCB, 0x2E, 0x0A);
            CodeEmitWorks("sra (ix-#08)", 0xDD, 0xCB, 0x2E, 0xF8);
            CodeEmitWorks("sra (ix),a", 0xDD, 0xCB, 0x2F, 0x00);
            CodeEmitWorks("sra (ix+#0A),a", 0xDD, 0xCB, 0x2F, 0x0A);
            CodeEmitWorks("sra (ix-#08),a", 0xDD, 0xCB, 0x2F, 0xF8);

            CodeEmitWorks("sll (ix),b", 0xDD, 0xCB, 0x30, 0x00);
            CodeEmitWorks("sll (ix+#0A),b", 0xDD, 0xCB, 0x30, 0x0A);
            CodeEmitWorks("sll (ix-#08),b", 0xDD, 0xCB, 0x30, 0xF8);
            CodeEmitWorks("sll (ix),c", 0xDD, 0xCB, 0x31, 0x00);
            CodeEmitWorks("sll (ix+#0A),c", 0xDD, 0xCB, 0x31, 0x0A);
            CodeEmitWorks("sll (ix-#08),c", 0xDD, 0xCB, 0x31, 0xF8);
            CodeEmitWorks("sll (ix),d", 0xDD, 0xCB, 0x32, 0x00);
            CodeEmitWorks("sll (ix+#0A),d", 0xDD, 0xCB, 0x32, 0x0A);
            CodeEmitWorks("sll (ix-#08),d", 0xDD, 0xCB, 0x32, 0xF8);
            CodeEmitWorks("sll (ix),e", 0xDD, 0xCB, 0x33, 0x00);
            CodeEmitWorks("sll (ix+#0A),e", 0xDD, 0xCB, 0x33, 0x0A);
            CodeEmitWorks("sll (ix-#08),e", 0xDD, 0xCB, 0x33, 0xF8);
            CodeEmitWorks("sll (ix),h", 0xDD, 0xCB, 0x34, 0x00);
            CodeEmitWorks("sll (ix+#0A),h", 0xDD, 0xCB, 0x34, 0x0A);
            CodeEmitWorks("sll (ix-#08),h", 0xDD, 0xCB, 0x34, 0xF8);
            CodeEmitWorks("sll (ix),l", 0xDD, 0xCB, 0x35, 0x00);
            CodeEmitWorks("sll (ix+#0A),l", 0xDD, 0xCB, 0x35, 0x0A);
            CodeEmitWorks("sll (ix-#08),l", 0xDD, 0xCB, 0x35, 0xF8);
            CodeEmitWorks("sll (ix)", 0xDD, 0xCB, 0x36, 0x00);
            CodeEmitWorks("sll (ix+#0A)", 0xDD, 0xCB, 0x36, 0x0A);
            CodeEmitWorks("sll (ix-#08)", 0xDD, 0xCB, 0x36, 0xF8);
            CodeEmitWorks("sll (ix),a", 0xDD, 0xCB, 0x37, 0x00);
            CodeEmitWorks("sll (ix+#0A),a", 0xDD, 0xCB, 0x37, 0x0A);
            CodeEmitWorks("sll (ix-#08),a", 0xDD, 0xCB, 0x37, 0xF8);

            CodeEmitWorks("srl (ix),b", 0xDD, 0xCB, 0x38, 0x00);
            CodeEmitWorks("srl (ix+#0A),b", 0xDD, 0xCB, 0x38, 0x0A);
            CodeEmitWorks("srl (ix-#08),b", 0xDD, 0xCB, 0x38, 0xF8);
            CodeEmitWorks("srl (ix),c", 0xDD, 0xCB, 0x39, 0x00);
            CodeEmitWorks("srl (ix+#0A),c", 0xDD, 0xCB, 0x39, 0x0A);
            CodeEmitWorks("srl (ix-#08),c", 0xDD, 0xCB, 0x39, 0xF8);
            CodeEmitWorks("srl (ix),d", 0xDD, 0xCB, 0x3A, 0x00);
            CodeEmitWorks("srl (ix+#0A),d", 0xDD, 0xCB, 0x3A, 0x0A);
            CodeEmitWorks("srl (ix-#08),d", 0xDD, 0xCB, 0x3A, 0xF8);
            CodeEmitWorks("srl (ix),e", 0xDD, 0xCB, 0x3B, 0x00);
            CodeEmitWorks("srl (ix+#0A),e", 0xDD, 0xCB, 0x3B, 0x0A);
            CodeEmitWorks("srl (ix-#08),e", 0xDD, 0xCB, 0x3B, 0xF8);
            CodeEmitWorks("srl (ix),h", 0xDD, 0xCB, 0x3C, 0x00);
            CodeEmitWorks("srl (ix+#0A),h", 0xDD, 0xCB, 0x3C, 0x0A);
            CodeEmitWorks("srl (ix-#08),h", 0xDD, 0xCB, 0x3C, 0xF8);
            CodeEmitWorks("srl (ix),l", 0xDD, 0xCB, 0x3D, 0x00);
            CodeEmitWorks("srl (ix+#0A),l", 0xDD, 0xCB, 0x3D, 0x0A);
            CodeEmitWorks("srl (ix-#08),l", 0xDD, 0xCB, 0x3D, 0xF8);
            CodeEmitWorks("srl (ix)", 0xDD, 0xCB, 0x3E, 0x00);
            CodeEmitWorks("srl (ix+#0A)", 0xDD, 0xCB, 0x3E, 0x0A);
            CodeEmitWorks("srl (ix-#08)", 0xDD, 0xCB, 0x3E, 0xF8);
            CodeEmitWorks("srl (ix),a", 0xDD, 0xCB, 0x3F, 0x00);
            CodeEmitWorks("srl (ix+#0A),a", 0xDD, 0xCB, 0x3F, 0x0A);
            CodeEmitWorks("srl (ix-#08),a", 0xDD, 0xCB, 0x3F, 0xF8);
        }

        [TestMethod]
        public void IyIndexedSrOpsWorkAsExpected()
        {
            CodeEmitWorks("rlc (iy),b", 0xFD, 0xCB, 0x00, 0x00);
            CodeEmitWorks("rlc (iy+#0A),b", 0xFD, 0xCB, 0x00, 0x0A);
            CodeEmitWorks("rlc (iy-#08),b", 0xFD, 0xCB, 0x00, 0xF8);
            CodeEmitWorks("rlc (iy),c", 0xFD, 0xCB, 0x01, 0x00);
            CodeEmitWorks("rlc (iy+#0A),c", 0xFD, 0xCB, 0x01, 0x0A);
            CodeEmitWorks("rlc (iy-#08),c", 0xFD, 0xCB, 0x01, 0xF8);
            CodeEmitWorks("rlc (iy),d", 0xFD, 0xCB, 0x02, 0x00);
            CodeEmitWorks("rlc (iy+#0A),d", 0xFD, 0xCB, 0x02, 0x0A);
            CodeEmitWorks("rlc (iy-#08),d", 0xFD, 0xCB, 0x02, 0xF8);
            CodeEmitWorks("rlc (iy),e", 0xFD, 0xCB, 0x03, 0x00);
            CodeEmitWorks("rlc (iy+#0A),e", 0xFD, 0xCB, 0x03, 0x0A);
            CodeEmitWorks("rlc (iy-#08),e", 0xFD, 0xCB, 0x03, 0xF8);
            CodeEmitWorks("rlc (iy),h", 0xFD, 0xCB, 0x04, 0x00);
            CodeEmitWorks("rlc (iy+#0A),h", 0xFD, 0xCB, 0x04, 0x0A);
            CodeEmitWorks("rlc (iy-#08),h", 0xFD, 0xCB, 0x04, 0xF8);
            CodeEmitWorks("rlc (iy),l", 0xFD, 0xCB, 0x05, 0x00);
            CodeEmitWorks("rlc (iy+#0A),l", 0xFD, 0xCB, 0x05, 0x0A);
            CodeEmitWorks("rlc (iy-#08),l", 0xFD, 0xCB, 0x05, 0xF8);
            CodeEmitWorks("rlc (iy)", 0xFD, 0xCB, 0x06, 0x00);
            CodeEmitWorks("rlc (iy+#0A)", 0xFD, 0xCB, 0x06, 0x0A);
            CodeEmitWorks("rlc (iy-#08)", 0xFD, 0xCB, 0x06, 0xF8);
            CodeEmitWorks("rlc (iy),a", 0xFD, 0xCB, 0x07, 0x00);
            CodeEmitWorks("rlc (iy+#0A),a", 0xFD, 0xCB, 0x07, 0x0A);
            CodeEmitWorks("rlc (iy-#08),a", 0xFD, 0xCB, 0x07, 0xF8);

            CodeEmitWorks("rrc (iy),b", 0xFD, 0xCB, 0x08, 0x00);
            CodeEmitWorks("rrc (iy+#0A),b", 0xFD, 0xCB, 0x08, 0x0A);
            CodeEmitWorks("rrc (iy-#08),b", 0xFD, 0xCB, 0x08, 0xF8);
            CodeEmitWorks("rrc (iy),c", 0xFD, 0xCB, 0x09, 0x00);
            CodeEmitWorks("rrc (iy+#0A),c", 0xFD, 0xCB, 0x09, 0x0A);
            CodeEmitWorks("rrc (iy-#08),c", 0xFD, 0xCB, 0x09, 0xF8);
            CodeEmitWorks("rrc (iy),d", 0xFD, 0xCB, 0x0A, 0x00);
            CodeEmitWorks("rrc (iy+#0A),d", 0xFD, 0xCB, 0x0A, 0x0A);
            CodeEmitWorks("rrc (iy-#08),d", 0xFD, 0xCB, 0x0A, 0xF8);
            CodeEmitWorks("rrc (iy),e", 0xFD, 0xCB, 0x0B, 0x00);
            CodeEmitWorks("rrc (iy+#0A),e", 0xFD, 0xCB, 0x0B, 0x0A);
            CodeEmitWorks("rrc (iy-#08),e", 0xFD, 0xCB, 0x0B, 0xF8);
            CodeEmitWorks("rrc (iy),h", 0xFD, 0xCB, 0x0C, 0x00);
            CodeEmitWorks("rrc (iy+#0A),h", 0xFD, 0xCB, 0x0C, 0x0A);
            CodeEmitWorks("rrc (iy-#08),h", 0xFD, 0xCB, 0x0C, 0xF8);
            CodeEmitWorks("rrc (iy),l", 0xFD, 0xCB, 0x0D, 0x00);
            CodeEmitWorks("rrc (iy+#0A),l", 0xFD, 0xCB, 0x0D, 0x0A);
            CodeEmitWorks("rrc (iy-#08),l", 0xFD, 0xCB, 0x0D, 0xF8);
            CodeEmitWorks("rrc (iy)", 0xFD, 0xCB, 0x0E, 0x00);
            CodeEmitWorks("rrc (iy+#0A)", 0xFD, 0xCB, 0x0E, 0x0A);
            CodeEmitWorks("rrc (iy-#08)", 0xFD, 0xCB, 0x0E, 0xF8);
            CodeEmitWorks("rrc (iy),a", 0xFD, 0xCB, 0x0F, 0x00);
            CodeEmitWorks("rrc (iy+#0A),a", 0xFD, 0xCB, 0x0F, 0x0A);
            CodeEmitWorks("rrc (iy-#08),a", 0xFD, 0xCB, 0x0F, 0xF8);

            CodeEmitWorks("rl (iy),b", 0xFD, 0xCB, 0x10, 0x00);
            CodeEmitWorks("rl (iy+#0A),b", 0xFD, 0xCB, 0x10, 0x0A);
            CodeEmitWorks("rl (iy-#08),b", 0xFD, 0xCB, 0x10, 0xF8);
            CodeEmitWorks("rl (iy),c", 0xFD, 0xCB, 0x11, 0x00);
            CodeEmitWorks("rl (iy+#0A),c", 0xFD, 0xCB, 0x11, 0x0A);
            CodeEmitWorks("rl (iy-#08),c", 0xFD, 0xCB, 0x11, 0xF8);
            CodeEmitWorks("rl (iy),d", 0xFD, 0xCB, 0x12, 0x00);
            CodeEmitWorks("rl (iy+#0A),d", 0xFD, 0xCB, 0x12, 0x0A);
            CodeEmitWorks("rl (iy-#08),d", 0xFD, 0xCB, 0x12, 0xF8);
            CodeEmitWorks("rl (iy),e", 0xFD, 0xCB, 0x13, 0x00);
            CodeEmitWorks("rl (iy+#0A),e", 0xFD, 0xCB, 0x13, 0x0A);
            CodeEmitWorks("rl (iy-#08),e", 0xFD, 0xCB, 0x13, 0xF8);
            CodeEmitWorks("rl (iy),h", 0xFD, 0xCB, 0x14, 0x00);
            CodeEmitWorks("rl (iy+#0A),h", 0xFD, 0xCB, 0x14, 0x0A);
            CodeEmitWorks("rl (iy-#08),h", 0xFD, 0xCB, 0x14, 0xF8);
            CodeEmitWorks("rl (iy),l", 0xFD, 0xCB, 0x15, 0x00);
            CodeEmitWorks("rl (iy+#0A),l", 0xFD, 0xCB, 0x15, 0x0A);
            CodeEmitWorks("rl (iy-#08),l", 0xFD, 0xCB, 0x15, 0xF8);
            CodeEmitWorks("rl (iy)", 0xFD, 0xCB, 0x16, 0x00);
            CodeEmitWorks("rl (iy+#0A)", 0xFD, 0xCB, 0x16, 0x0A);
            CodeEmitWorks("rl (iy-#08)", 0xFD, 0xCB, 0x16, 0xF8);
            CodeEmitWorks("rl (iy),a", 0xFD, 0xCB, 0x17, 0x00);
            CodeEmitWorks("rl (iy+#0A),a", 0xFD, 0xCB, 0x17, 0x0A);
            CodeEmitWorks("rl (iy-#08),a", 0xFD, 0xCB, 0x17, 0xF8);

            CodeEmitWorks("rr (iy),b", 0xFD, 0xCB, 0x18, 0x00);
            CodeEmitWorks("rr (iy+#0A),b", 0xFD, 0xCB, 0x18, 0x0A);
            CodeEmitWorks("rr (iy-#08),b", 0xFD, 0xCB, 0x18, 0xF8);
            CodeEmitWorks("rr (iy),c", 0xFD, 0xCB, 0x19, 0x00);
            CodeEmitWorks("rr (iy+#0A),c", 0xFD, 0xCB, 0x19, 0x0A);
            CodeEmitWorks("rr (iy-#08),c", 0xFD, 0xCB, 0x19, 0xF8);
            CodeEmitWorks("rr (iy),d", 0xFD, 0xCB, 0x1A, 0x00);
            CodeEmitWorks("rr (iy+#0A),d", 0xFD, 0xCB, 0x1A, 0x0A);
            CodeEmitWorks("rr (iy-#08),d", 0xFD, 0xCB, 0x1A, 0xF8);
            CodeEmitWorks("rr (iy),e", 0xFD, 0xCB, 0x1B, 0x00);
            CodeEmitWorks("rr (iy+#0A),e", 0xFD, 0xCB, 0x1B, 0x0A);
            CodeEmitWorks("rr (iy-#08),e", 0xFD, 0xCB, 0x1B, 0xF8);
            CodeEmitWorks("rr (iy),h", 0xFD, 0xCB, 0x1C, 0x00);
            CodeEmitWorks("rr (iy+#0A),h", 0xFD, 0xCB, 0x1C, 0x0A);
            CodeEmitWorks("rr (iy-#08),h", 0xFD, 0xCB, 0x1C, 0xF8);
            CodeEmitWorks("rr (iy),l", 0xFD, 0xCB, 0x1D, 0x00);
            CodeEmitWorks("rr (iy+#0A),l", 0xFD, 0xCB, 0x1D, 0x0A);
            CodeEmitWorks("rr (iy-#08),l", 0xFD, 0xCB, 0x1D, 0xF8);
            CodeEmitWorks("rr (iy)", 0xFD, 0xCB, 0x1E, 0x00);
            CodeEmitWorks("rr (iy+#0A)", 0xFD, 0xCB, 0x1E, 0x0A);
            CodeEmitWorks("rr (iy-#08)", 0xFD, 0xCB, 0x1E, 0xF8);
            CodeEmitWorks("rr (iy),a", 0xFD, 0xCB, 0x1F, 0x00);
            CodeEmitWorks("rr (iy+#0A),a", 0xFD, 0xCB, 0x1F, 0x0A);
            CodeEmitWorks("rr (iy-#08),a", 0xFD, 0xCB, 0x1F, 0xF8);

            CodeEmitWorks("sla (iy),b", 0xFD, 0xCB, 0x20, 0x00);
            CodeEmitWorks("sla (iy+#0A),b", 0xFD, 0xCB, 0x20, 0x0A);
            CodeEmitWorks("sla (iy-#08),b", 0xFD, 0xCB, 0x20, 0xF8);
            CodeEmitWorks("sla (iy),c", 0xFD, 0xCB, 0x21, 0x00);
            CodeEmitWorks("sla (iy+#0A),c", 0xFD, 0xCB, 0x21, 0x0A);
            CodeEmitWorks("sla (iy-#08),c", 0xFD, 0xCB, 0x21, 0xF8);
            CodeEmitWorks("sla (iy),d", 0xFD, 0xCB, 0x22, 0x00);
            CodeEmitWorks("sla (iy+#0A),d", 0xFD, 0xCB, 0x22, 0x0A);
            CodeEmitWorks("sla (iy-#08),d", 0xFD, 0xCB, 0x22, 0xF8);
            CodeEmitWorks("sla (iy),e", 0xFD, 0xCB, 0x23, 0x00);
            CodeEmitWorks("sla (iy+#0A),e", 0xFD, 0xCB, 0x23, 0x0A);
            CodeEmitWorks("sla (iy-#08),e", 0xFD, 0xCB, 0x23, 0xF8);
            CodeEmitWorks("sla (iy),h", 0xFD, 0xCB, 0x24, 0x00);
            CodeEmitWorks("sla (iy+#0A),h", 0xFD, 0xCB, 0x24, 0x0A);
            CodeEmitWorks("sla (iy-#08),h", 0xFD, 0xCB, 0x24, 0xF8);
            CodeEmitWorks("sla (iy),l", 0xFD, 0xCB, 0x25, 0x00);
            CodeEmitWorks("sla (iy+#0A),l", 0xFD, 0xCB, 0x25, 0x0A);
            CodeEmitWorks("sla (iy-#08),l", 0xFD, 0xCB, 0x25, 0xF8);
            CodeEmitWorks("sla (iy)", 0xFD, 0xCB, 0x26, 0x00);
            CodeEmitWorks("sla (iy+#0A)", 0xFD, 0xCB, 0x26, 0x0A);
            CodeEmitWorks("sla (iy-#08)", 0xFD, 0xCB, 0x26, 0xF8);
            CodeEmitWorks("sla (iy),a", 0xFD, 0xCB, 0x27, 0x00);
            CodeEmitWorks("sla (iy+#0A),a", 0xFD, 0xCB, 0x27, 0x0A);
            CodeEmitWorks("sla (iy-#08),a", 0xFD, 0xCB, 0x27, 0xF8);

            CodeEmitWorks("sra (iy),b", 0xFD, 0xCB, 0x28, 0x00);
            CodeEmitWorks("sra (iy+#0A),b", 0xFD, 0xCB, 0x28, 0x0A);
            CodeEmitWorks("sra (iy-#08),b", 0xFD, 0xCB, 0x28, 0xF8);
            CodeEmitWorks("sra (iy),c", 0xFD, 0xCB, 0x29, 0x00);
            CodeEmitWorks("sra (iy+#0A),c", 0xFD, 0xCB, 0x29, 0x0A);
            CodeEmitWorks("sra (iy-#08),c", 0xFD, 0xCB, 0x29, 0xF8);
            CodeEmitWorks("sra (iy),d", 0xFD, 0xCB, 0x2A, 0x00);
            CodeEmitWorks("sra (iy+#0A),d", 0xFD, 0xCB, 0x2A, 0x0A);
            CodeEmitWorks("sra (iy-#08),d", 0xFD, 0xCB, 0x2A, 0xF8);
            CodeEmitWorks("sra (iy),e", 0xFD, 0xCB, 0x2B, 0x00);
            CodeEmitWorks("sra (iy+#0A),e", 0xFD, 0xCB, 0x2B, 0x0A);
            CodeEmitWorks("sra (iy-#08),e", 0xFD, 0xCB, 0x2B, 0xF8);
            CodeEmitWorks("sra (iy),h", 0xFD, 0xCB, 0x2C, 0x00);
            CodeEmitWorks("sra (iy+#0A),h", 0xFD, 0xCB, 0x2C, 0x0A);
            CodeEmitWorks("sra (iy-#08),h", 0xFD, 0xCB, 0x2C, 0xF8);
            CodeEmitWorks("sra (iy),l", 0xFD, 0xCB, 0x2D, 0x00);
            CodeEmitWorks("sra (iy+#0A),l", 0xFD, 0xCB, 0x2D, 0x0A);
            CodeEmitWorks("sra (iy-#08),l", 0xFD, 0xCB, 0x2D, 0xF8);
            CodeEmitWorks("sra (iy)", 0xFD, 0xCB, 0x2E, 0x00);
            CodeEmitWorks("sra (iy+#0A)", 0xFD, 0xCB, 0x2E, 0x0A);
            CodeEmitWorks("sra (iy-#08)", 0xFD, 0xCB, 0x2E, 0xF8);
            CodeEmitWorks("sra (iy),a", 0xFD, 0xCB, 0x2F, 0x00);
            CodeEmitWorks("sra (iy+#0A),a", 0xFD, 0xCB, 0x2F, 0x0A);
            CodeEmitWorks("sra (iy-#08),a", 0xFD, 0xCB, 0x2F, 0xF8);

            CodeEmitWorks("sll (iy),b", 0xFD, 0xCB, 0x30, 0x00);
            CodeEmitWorks("sll (iy+#0A),b", 0xFD, 0xCB, 0x30, 0x0A);
            CodeEmitWorks("sll (iy-#08),b", 0xFD, 0xCB, 0x30, 0xF8);
            CodeEmitWorks("sll (iy),c", 0xFD, 0xCB, 0x31, 0x00);
            CodeEmitWorks("sll (iy+#0A),c", 0xFD, 0xCB, 0x31, 0x0A);
            CodeEmitWorks("sll (iy-#08),c", 0xFD, 0xCB, 0x31, 0xF8);
            CodeEmitWorks("sll (iy),d", 0xFD, 0xCB, 0x32, 0x00);
            CodeEmitWorks("sll (iy+#0A),d", 0xFD, 0xCB, 0x32, 0x0A);
            CodeEmitWorks("sll (iy-#08),d", 0xFD, 0xCB, 0x32, 0xF8);
            CodeEmitWorks("sll (iy),e", 0xFD, 0xCB, 0x33, 0x00);
            CodeEmitWorks("sll (iy+#0A),e", 0xFD, 0xCB, 0x33, 0x0A);
            CodeEmitWorks("sll (iy-#08),e", 0xFD, 0xCB, 0x33, 0xF8);
            CodeEmitWorks("sll (iy),h", 0xFD, 0xCB, 0x34, 0x00);
            CodeEmitWorks("sll (iy+#0A),h", 0xFD, 0xCB, 0x34, 0x0A);
            CodeEmitWorks("sll (iy-#08),h", 0xFD, 0xCB, 0x34, 0xF8);
            CodeEmitWorks("sll (iy),l", 0xFD, 0xCB, 0x35, 0x00);
            CodeEmitWorks("sll (iy+#0A),l", 0xFD, 0xCB, 0x35, 0x0A);
            CodeEmitWorks("sll (iy-#08),l", 0xFD, 0xCB, 0x35, 0xF8);
            CodeEmitWorks("sll (iy)", 0xFD, 0xCB, 0x36, 0x00);
            CodeEmitWorks("sll (iy+#0A)", 0xFD, 0xCB, 0x36, 0x0A);
            CodeEmitWorks("sll (iy-#08)", 0xFD, 0xCB, 0x36, 0xF8);
            CodeEmitWorks("sll (iy),a", 0xFD, 0xCB, 0x37, 0x00);
            CodeEmitWorks("sll (iy+#0A),a", 0xFD, 0xCB, 0x37, 0x0A);
            CodeEmitWorks("sll (iy-#08),a", 0xFD, 0xCB, 0x37, 0xF8);

            CodeEmitWorks("srl (iy),b", 0xFD, 0xCB, 0x38, 0x00);
            CodeEmitWorks("srl (iy+#0A),b", 0xFD, 0xCB, 0x38, 0x0A);
            CodeEmitWorks("srl (iy-#08),b", 0xFD, 0xCB, 0x38, 0xF8);
            CodeEmitWorks("srl (iy),c", 0xFD, 0xCB, 0x39, 0x00);
            CodeEmitWorks("srl (iy+#0A),c", 0xFD, 0xCB, 0x39, 0x0A);
            CodeEmitWorks("srl (iy-#08),c", 0xFD, 0xCB, 0x39, 0xF8);
            CodeEmitWorks("srl (iy),d", 0xFD, 0xCB, 0x3A, 0x00);
            CodeEmitWorks("srl (iy+#0A),d", 0xFD, 0xCB, 0x3A, 0x0A);
            CodeEmitWorks("srl (iy-#08),d", 0xFD, 0xCB, 0x3A, 0xF8);
            CodeEmitWorks("srl (iy),e", 0xFD, 0xCB, 0x3B, 0x00);
            CodeEmitWorks("srl (iy+#0A),e", 0xFD, 0xCB, 0x3B, 0x0A);
            CodeEmitWorks("srl (iy-#08),e", 0xFD, 0xCB, 0x3B, 0xF8);
            CodeEmitWorks("srl (iy),h", 0xFD, 0xCB, 0x3C, 0x00);
            CodeEmitWorks("srl (iy+#0A),h", 0xFD, 0xCB, 0x3C, 0x0A);
            CodeEmitWorks("srl (iy-#08),h", 0xFD, 0xCB, 0x3C, 0xF8);
            CodeEmitWorks("srl (iy),l", 0xFD, 0xCB, 0x3D, 0x00);
            CodeEmitWorks("srl (iy+#0A),l", 0xFD, 0xCB, 0x3D, 0x0A);
            CodeEmitWorks("srl (iy-#08),l", 0xFD, 0xCB, 0x3D, 0xF8);
            CodeEmitWorks("srl (iy)", 0xFD, 0xCB, 0x3E, 0x00);
            CodeEmitWorks("srl (iy+#0A)", 0xFD, 0xCB, 0x3E, 0x0A);
            CodeEmitWorks("srl (iy-#08)", 0xFD, 0xCB, 0x3E, 0xF8);
            CodeEmitWorks("srl (iy),a", 0xFD, 0xCB, 0x3F, 0x00);
            CodeEmitWorks("srl (iy+#0A),a", 0xFD, 0xCB, 0x3F, 0x0A);
            CodeEmitWorks("srl (iy-#08),a", 0xFD, 0xCB, 0x3F, 0xF8);
        }
    }
}